version: "3"

services:

  # makefile makes a directory.

  makefile:
    container_name: senzing-makefile
    command:
      - sh
      - -c
      - mkdir /output/sqlite
    image: busybox@sha256:d82f458899c9696cb26a7c02d5568f81c8c8223f8661bb2a7988b269c8b9051e
    networks:
      - senzing
    read_only: true
    user: ${SENZING_UID:-1001}:${SENZING_GID:-1001}
    volumes:
      - /tmp:/output

  sqlite-web:
    container_name: senzing-sqlite-web
    depends_on:
      - makefile
    environment:
      SQLITE_DATABASE: "G2C.db"
    image: coleifer/sqlite-web@sha256:1e5b86237968ed747554f951c6df2fc2fe4bf4ef070b8ca23d553d7f6c6426f7
    networks:
      - senzing
    ports:
      - 9174:8080
    restart: always
    user: "${SENZING_UID:-1001}:0"
    volumes:
      - /tmp/sqlite:/data

  sqlite-init:
    container_name: senzing-postgres-init
    depends_on:
      - sqlite-web
    environment:
      SENZING_TOOLS_DATABASE_URL: "sqlite3://na:na@/data/G2C.db"
      SENZING_TOOLS_DATASOURCES: "CUSTOMERS, REFERENCE, WATCHLIST"
    image: senzing/init-database@sha256:4a7b6c887b9c012d4e2ce32517ea94023d41549ec852f4fa59b5bd2341e9aa54
    networks:
      - senzing
    volumes:
      - /tmp/sqlite:/data

networks:
  senzing:
    name: ${SENZING_DOCKER_NETWORK:-senzing}
